---
ms.date: 09/13/2016
ms.topic: reference
title: 如何创建控制台 Shell
description: 如何创建控制台 Shell
ms.openlocfilehash: 9ea67c43b1ee35b1fbfc553b22a1423419317ca2
ms.sourcegitcommit: ba7315a496986451cfc1296b659d73ea2373d3f0
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/10/2020
ms.locfileid: "92657227"
---
# <a name="how-to-create-a-console-shell"></a><span data-ttu-id="43af4-103">如何创建控制台 Shell</span><span class="sxs-lookup"><span data-stu-id="43af4-103">How to Create a Console Shell</span></span>

<span data-ttu-id="43af4-104">Windows PowerShell 提供了一个 Make-Shell 工具（也称为 "生成套件"），用于创建不可扩展的控制台 shell。</span><span class="sxs-lookup"><span data-stu-id="43af4-104">Windows PowerShell provides a Make-Shell tool, also referred to as the "make-kit", that is used to create a console shell that is not extensible.</span></span> <span data-ttu-id="43af4-105">以后使用此新工具创建的 shell 无法通过 Windows PowerShell 管理单元进行扩展。</span><span class="sxs-lookup"><span data-stu-id="43af4-105">Shells created with this new tool cannot be extended later through a Windows PowerShell snap-in.</span></span>

## <a name="syntax"></a><span data-ttu-id="43af4-106">语法</span><span class="sxs-lookup"><span data-stu-id="43af4-106">Syntax</span></span>

<span data-ttu-id="43af4-107">下面是用于从文件中运行 Make-Shell 的语法。</span><span class="sxs-lookup"><span data-stu-id="43af4-107">Here is the syntax used to run Make-Shell from within a make-file.</span></span>

```
make-shell
  -out n.exe
  -namespace ns
  [ -lib libdirectory1[,libdirectory2,..] ]
  [ -reference ca1.dll[,ca2.dll,...] ]
  [ -formatdata fd1.format.ps1xml[,fd2.format.ps1xml,...] ]
  [ -typedata td1.type.ps1xml[,td2.type.ps1xml,...] ]
  [ -source c1.cs [,c2.cs,...] ]
  [ -authorizationmanager authorizationManagerType ]
  [ -win32icon i.ico ]
  [ -initscript p.ps1 ]
  [ -builtinscript s1.ps1[,s2.ps1,...] ]
  [ -resource resourcefile.txt ]
  [ -cscflags cscFlags ]
  [ -? | -help ]
```

## <a name="parameters"></a><span data-ttu-id="43af4-108">parameters</span><span class="sxs-lookup"><span data-stu-id="43af4-108">Parameters</span></span>

<span data-ttu-id="43af4-109">下面是有关 Make Shell 的参数的简短说明。</span><span class="sxs-lookup"><span data-stu-id="43af4-109">Here is a brief description of the parameters of Make-Shell.</span></span>

> [!CAUTION]
> <span data-ttu-id="43af4-110">Make Shell 不支持程序集的 UNC 路径。</span><span class="sxs-lookup"><span data-stu-id="43af4-110">UNC paths to assemblies are not supported by Make-Shell.</span></span>

|<span data-ttu-id="43af4-111">参数</span><span class="sxs-lookup"><span data-stu-id="43af4-111">Parameter</span></span>|<span data-ttu-id="43af4-112">描述</span><span class="sxs-lookup"><span data-stu-id="43af4-112">Description</span></span>|
|---------------|-----------------|
|<span data-ttu-id="43af4-113">-out n.exe</span><span class="sxs-lookup"><span data-stu-id="43af4-113">-out n.exe</span></span>|<span data-ttu-id="43af4-114">必需。</span><span class="sxs-lookup"><span data-stu-id="43af4-114">Required.</span></span> <span data-ttu-id="43af4-115">要生成的 shell 的名称。</span><span class="sxs-lookup"><span data-stu-id="43af4-115">The name of the shell to produce.</span></span> <span data-ttu-id="43af4-116">该路径指定为此参数的一部分。</span><span class="sxs-lookup"><span data-stu-id="43af4-116">The path is specified as part of this parameter.</span></span><br /><br /> <span data-ttu-id="43af4-117">如果未指定此值，则会将 ".exe" 追加到此值。</span><span class="sxs-lookup"><span data-stu-id="43af4-117">Make-shell will append ".exe" to this value if it is not specified.</span></span> <span data-ttu-id="43af4-118">**警告：**  不要使用与所引用 .dll 文件相同的名称来创建输出文件。</span><span class="sxs-lookup"><span data-stu-id="43af4-118">**Caution:**  Do not create an output file with the same name as the referenced .dll file.</span></span> <span data-ttu-id="43af4-119">如果尝试这样做，Make-Shell 工具会创建一个具有相同名称的 .cs 文件，该文件将覆盖包含 cmdlet 源代码的 .cs 文件。</span><span class="sxs-lookup"><span data-stu-id="43af4-119">If you attempt this, the Make-Shell tool creates a .cs file with the same name, which will overwrite the .cs file that has your cmdlet source code.</span></span>|
|<span data-ttu-id="43af4-120">-命名空间 ns</span><span class="sxs-lookup"><span data-stu-id="43af4-120">-namespace ns</span></span>|<span data-ttu-id="43af4-121">必需。</span><span class="sxs-lookup"><span data-stu-id="43af4-121">Required.</span></span> <span data-ttu-id="43af4-122">生成和编译生成和编译的派生的 [Runspaceconfiguration](/dotnet/api/System.Management.Automation.Runspaces.RunspaceConfiguration) 类所使用的命名空间。</span><span class="sxs-lookup"><span data-stu-id="43af4-122">The namespace to use for the derived [System.Management.Automation.Runspaces.Runspaceconfiguration](/dotnet/api/System.Management.Automation.Runspaces.RunspaceConfiguration) class that the make-kit generates and compiles.</span></span>|
|<span data-ttu-id="43af4-123">-lib libdirectory1 [，libdirectory2,..]</span><span class="sxs-lookup"><span data-stu-id="43af4-123">-lib libdirectory1[,libdirectory2,..]</span></span>|<span data-ttu-id="43af4-124">搜索 .NET 程序集的目录，包括 Windows PowerShell 程序集、参数指定的程序集 `reference` 、其他程序集间接引用的程序集以及 .net 系统程序集。</span><span class="sxs-lookup"><span data-stu-id="43af4-124">The directories that are searched for .NET assemblies, including the Windows PowerShell assemblies, assemblies specified by the `reference` parameter, assemblies indirectly referenced by another assembly, and the .NET system assemblies.</span></span>|
|<span data-ttu-id="43af4-125">-引用 ca1.dll [，ca2.dll,...]</span><span class="sxs-lookup"><span data-stu-id="43af4-125">-reference ca1.dll[,ca2.dll,...]</span></span>|<span data-ttu-id="43af4-126">要包括在 shell 中的程序集的逗号分隔列表。</span><span class="sxs-lookup"><span data-stu-id="43af4-126">A comma-separated list of the assemblies to include in the shell.</span></span> <span data-ttu-id="43af4-127">这些程序集包括所有 cmdlet 和提供程序程序集，以及应加载的资源程序集。</span><span class="sxs-lookup"><span data-stu-id="43af4-127">These assemblies  includes all cmdlet and provider assemblies, as well as resource assemblies that should be loaded.</span></span> <span data-ttu-id="43af4-128">如果未指定此参数，则会生成一个 shell，其中只包含 Windows PowerShell 提供的核心 cmdlet 和提供程序。</span><span class="sxs-lookup"><span data-stu-id="43af4-128">If this parameter is not specified, then a shell is produced that contains only the core cmdlets and providers provided by Windows PowerShell.</span></span><br /><br /> <span data-ttu-id="43af4-129">可以使用其完整路径指定程序集，否则将使用参数指定的路径搜索这些程序集 `lib` 。</span><span class="sxs-lookup"><span data-stu-id="43af4-129">The assemblies can be specified using their full path, otherwise they will be searched for using the path specified by the `lib` parameter.</span></span>|
|<span data-ttu-id="43af4-130">-update-formatdata fd1.format.ps1xml [，fd2.format.ps1xml,...]</span><span class="sxs-lookup"><span data-stu-id="43af4-130">-formatdata fd1.format.ps1xml[,fd2.format.ps1xml,...]</span></span>|<span data-ttu-id="43af4-131">要包含在 shell 中的格式数据的逗号分隔列表。</span><span class="sxs-lookup"><span data-stu-id="43af4-131">A comma-separated list of format data to include in the shell.</span></span> <span data-ttu-id="43af4-132">如果未指定此参数，则会生成一个 shell，其中只包含 Windows PowerShell 提供的格式数据。</span><span class="sxs-lookup"><span data-stu-id="43af4-132">If this parameter is not specified, then a shell is produced that contains only the format data provided by Windows PowerShell.</span></span>|
|<span data-ttu-id="43af4-133">-update-typedata td1.type.ps1xml [，td2.type.ps1xml,...]</span><span class="sxs-lookup"><span data-stu-id="43af4-133">-typedata td1.type.ps1xml[,td2.type.ps1xml,...]</span></span>|<span data-ttu-id="43af4-134">要包含在 shell 中的类型数据的逗号分隔列表。</span><span class="sxs-lookup"><span data-stu-id="43af4-134">A comma-separated list of type data to include in the shell.</span></span> <span data-ttu-id="43af4-135">如果未指定此参数，则会生成一个 shell，其中只包含 Windows PowerShell 提供的类型数据。</span><span class="sxs-lookup"><span data-stu-id="43af4-135">If this parameter is not specified, then a shell is produced that contains only the type data provided by Windows PowerShell.</span></span>|
|<span data-ttu-id="43af4-136">-source c1.cs [，c2.cs,...]</span><span class="sxs-lookup"><span data-stu-id="43af4-136">-source c1.cs [,c2.cs,...]</span></span>|<span data-ttu-id="43af4-137">Shell 开发人员提供的文件的名称，其中包含生成 shell 所需的任何源代码。</span><span class="sxs-lookup"><span data-stu-id="43af4-137">The name of a file, provided by the shell developer, that contains any source code needed to build the shell.</span></span><br /><br /> <span data-ttu-id="43af4-138">源代码文件可以包含以下任何源代码：</span><span class="sxs-lookup"><span data-stu-id="43af4-138">The source code file can contain any of the following source code:</span></span><br /><br /> <span data-ttu-id="43af4-139">-替代默认授权管理器的授权管理器实现。</span><span class="sxs-lookup"><span data-stu-id="43af4-139">-   The Authorization manager implementation that overrides the default authorization manager.</span></span> <span data-ttu-id="43af4-140"> (还可以将其提供编译到程序集中。 ) </span><span class="sxs-lookup"><span data-stu-id="43af4-140">(This could also be supplied compiled into an assembly.)</span></span><br /><span data-ttu-id="43af4-141">-Assembly 信息性特性声明：例如，System.reflection.assemblycompanyattribute>、AssemblyCopyrightAttribute、AssemblyFileVersionAttribute、System.reflection.assemblyinformationalversionattribute>、System.reflection.assemblyproductattribute> 和 System.reflection.assemblytrademarkattribute>。</span><span class="sxs-lookup"><span data-stu-id="43af4-141">-   Assembly informational attribute declarations: such as the AssemblyCompanyAttribute, AssemblyCopyrightAttribute, AssemblyFileVersionAttribute, AssemblyInformationalVersionAttribute, AssemblyProductAttribute, and AssemblyTrademarkAttribute.</span></span>|
|<span data-ttu-id="43af4-142">-authorizationmanager authorizationManagerType</span><span class="sxs-lookup"><span data-stu-id="43af4-142">-authorizationmanager authorizationManagerType</span></span>|<span data-ttu-id="43af4-143">包含授权管理器实现的类型。</span><span class="sxs-lookup"><span data-stu-id="43af4-143">The type that contains the authorization manager implementation.</span></span> <span data-ttu-id="43af4-144">这可以在源代码中定义，也可以编译到 (参数) 指定的程序集中 `reference` 。</span><span class="sxs-lookup"><span data-stu-id="43af4-144">This can be defined in source code, or compiled into an assembly (specified by the `reference` parameter).</span></span> <span data-ttu-id="43af4-145">如果未指定此参数，则使用默认的安全管理器。</span><span class="sxs-lookup"><span data-stu-id="43af4-145">If this parameter is not specified, the default security manager is used.</span></span> <span data-ttu-id="43af4-146">该值应该是完整的类型名称，包括命名空间。</span><span class="sxs-lookup"><span data-stu-id="43af4-146">The value should be the full type name, including namespaces.</span></span>|
|<span data-ttu-id="43af4-147">-win32icon</span><span class="sxs-lookup"><span data-stu-id="43af4-147">-win32icon i.ico</span></span>|<span data-ttu-id="43af4-148">Shell 的 .exe 文件的图标。</span><span class="sxs-lookup"><span data-stu-id="43af4-148">The icon for the .exe file for the shell.</span></span> <span data-ttu-id="43af4-149">如果未指定，则 shell 将具有 c # 编译器包含的图标，如果有任何)  (。</span><span class="sxs-lookup"><span data-stu-id="43af4-149">If not specified, then the shell will have the icon that the c# compiler includes (if any).</span></span>|
|<span data-ttu-id="43af4-150">-initscript p.ps1</span><span class="sxs-lookup"><span data-stu-id="43af4-150">-initscript p.ps1</span></span>|<span data-ttu-id="43af4-151">Shell 的启动配置文件。</span><span class="sxs-lookup"><span data-stu-id="43af4-151">The startup profile for the shell.</span></span> <span data-ttu-id="43af4-152">文件 "按原样" 提供;不会通过 Make Shell 完成有效性检查。</span><span class="sxs-lookup"><span data-stu-id="43af4-152">The file is included "as-is"; no validity checking is done by Make-Shell.</span></span>|
|<span data-ttu-id="43af4-153">-builtinscript s1.ps1 [，s2.ps1,...]</span><span class="sxs-lookup"><span data-stu-id="43af4-153">-builtinscript s1.ps1[,s2.ps1,...]</span></span>|<span data-ttu-id="43af4-154">Shell 的内置脚本的列表。</span><span class="sxs-lookup"><span data-stu-id="43af4-154">A list of built-in scripts for the shell.</span></span> <span data-ttu-id="43af4-155">在路径中的脚本之前会发现这些脚本，生成 shell 后，不能更改其内容。</span><span class="sxs-lookup"><span data-stu-id="43af4-155">These scripts are discovered before scripts in the path, and their contents cannot be changed once the shell is built.</span></span><br /><br /> <span data-ttu-id="43af4-156">文件 "按原样" 提供;不会通过 Make Shell 完成有效性检查。</span><span class="sxs-lookup"><span data-stu-id="43af4-156">The files are included "as-is"; no validity checking is done by Make-Shell.</span></span>|
|<span data-ttu-id="43af4-157">-resource resourcefile.txt</span><span class="sxs-lookup"><span data-stu-id="43af4-157">-resource resourcefile.txt</span></span>|<span data-ttu-id="43af4-158">包含 shell 帮助和横幅资源的 .txt 文件。</span><span class="sxs-lookup"><span data-stu-id="43af4-158">The .txt file containing help and banner resources for the shell.</span></span> <span data-ttu-id="43af4-159">第一个资源的名称为 ShellHelp，包含在用参数调用 shell 时显示的文本 `help` 。</span><span class="sxs-lookup"><span data-stu-id="43af4-159">The first resource is named ShellHelp, and contains the text displayed if the shell is invoked with the `help` parameter.</span></span> <span data-ttu-id="43af4-160">第二个资源命名为 ShellBanner，它包含在交互模式下启动 shell 时显示的文本和版权信息。</span><span class="sxs-lookup"><span data-stu-id="43af4-160">The second resource is named ShellBanner, and it contains the text and copyright information displayed when the shell is launched in interactive mode.</span></span><br /><br /> <span data-ttu-id="43af4-161">如果未提供此参数或这些资源不存在，则使用通用帮助和横幅。</span><span class="sxs-lookup"><span data-stu-id="43af4-161">If this parameter is not provided, or these resources are not present, then a generic help and banner are used.</span></span>|
|<span data-ttu-id="43af4-162">-cscflags cscFlags</span><span class="sxs-lookup"><span data-stu-id="43af4-162">-cscflags cscFlags</span></span>|<span data-ttu-id="43af4-163">应传递给 c # 编译器 ( # A0) 的标志。</span><span class="sxs-lookup"><span data-stu-id="43af4-163">Flags that should be passed to the C# compiler (csc.exe).</span></span> <span data-ttu-id="43af4-164">这些是通过未更改的传递的。</span><span class="sxs-lookup"><span data-stu-id="43af4-164">These are passed through unchanged.</span></span> <span data-ttu-id="43af4-165">如果此参数包含空格，则应将其括在双引号中。</span><span class="sxs-lookup"><span data-stu-id="43af4-165">If this parameter includes spaces, it should be surrounded in double-quotes.</span></span>|
|<span data-ttu-id="43af4-166">-?</span><span class="sxs-lookup"><span data-stu-id="43af4-166">-?</span></span><br /><br /> <span data-ttu-id="43af4-167">-help</span><span class="sxs-lookup"><span data-stu-id="43af4-167">-help</span></span>|<span data-ttu-id="43af4-168">显示版权消息和 Make-Shell 命令行选项。</span><span class="sxs-lookup"><span data-stu-id="43af4-168">Displays the copyright message and Make-Shell command line options.</span></span>|
|<span data-ttu-id="43af4-169">-verbose</span><span class="sxs-lookup"><span data-stu-id="43af4-169">-verbose</span></span>|<span data-ttu-id="43af4-170">在创建 shell 时显示详细信息。</span><span class="sxs-lookup"><span data-stu-id="43af4-170">Displays detailed information while the shell is being created.</span></span>|

## <a name="see-also"></a><span data-ttu-id="43af4-171">另请参阅</span><span class="sxs-lookup"><span data-stu-id="43af4-171">See Also</span></span>

[<span data-ttu-id="43af4-172">Windows PowerShell 程序员指南</span><span class="sxs-lookup"><span data-stu-id="43af4-172">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)

[<span data-ttu-id="43af4-173">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="43af4-173">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)
